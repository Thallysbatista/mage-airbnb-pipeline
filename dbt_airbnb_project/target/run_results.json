{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-07-24T19:56:08.889478Z", "invocation_id": "03388566-9169-4546-b508-7d9998c82f24", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.508345Z", "completed_at": "2025-07-24T19:56:08.514025Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.521700Z", "completed_at": "2025-07-24T19:56:08.521700Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016736268997192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.dim_calendar", "compiled": true, "compiled_code": "with calendar as (\r\n    select\r\n      date_day\r\n      ,extract(year from date_day)         as year\r\n      ,extract(month from date_day)        as month\r\n      ,format_date('%Y-%m', date_day)      as year_month\r\n      ,format_date('%b', date_day)         as month_name\r\n      ,extract(dayofweek from date_day)    as day_of_week\r\n      ,format_date('%A', date_day)         as day_name\r\n      ,extract(week from date_day)         as week\r\n      ,extract(quarter from date_day)      as quarter\r\n      ,case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend\r\n      ,case when date_day = current_date() then true else false end as is_today\r\n    from unnest(generate_date_array('2009-01-01', '2019-12-31', interval 1 day)) as date_day\r\n)\r\nselect * from calendar", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`dim_calendar`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.514025Z", "completed_at": "2025-07-24T19:56:08.522311Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.522311Z", "completed_at": "2025-07-24T19:56:08.522311Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01621389389038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_address", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    _id      as listing_id\n  ,address\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n)\n\nselect\n    listing_id\n  ,address.street                                           as street\n  ,address.suburb                                           as suburb\n  ,address.government_area                                  as government_area\n  ,address.market                                           as market\n  ,address.country                                          as country\n  ,address.country_code                                     as country_code\n  ,cast(address.location.coordinates[offset(1)] as FLOAT64) as latitude\n  ,cast(address.location.coordinates[offset(0)] as FLOAT64) as longitude\n  ,cast(address.location.is_location_exact as BOOLEAN)      as is_location_exact\nfrom src", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_address`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.514025Z", "completed_at": "2025-07-24T19:56:08.522311Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.522311Z", "completed_at": "2025-07-24T19:56:08.522311Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015633821487426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_availability", "compiled": true, "compiled_code": "\n\nwith src as (\n  select\n    _id                                   as listing_id\n  , availability\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n)\n\nselect\n    listing_id\n  ,cast(availability.availability_30  as INT64) as available_30\n  ,cast(availability.availability_60  as INT64) as available_60\n  ,cast(availability.availability_90  as INT64) as available_90\n  ,cast(availability.availability_365 as INT64) as available_365\nfrom src", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_availability`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.514025Z", "completed_at": "2025-07-24T19:56:08.522311Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.522311Z", "completed_at": "2025-07-24T19:56:08.522311Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0233151912689209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_hosts", "compiled": true, "compiled_code": "\n\nwith source as (\n  select *\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n)\n\nselect\n    cast(host.host_id       as STRING)  as host_id\n  ,cast(host.host_name     as STRING)   as host_name\n  ,cast(host.host_location as STRING)   as host_location\nfrom source", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_hosts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.530551Z", "completed_at": "2025-07-24T19:56:08.530551Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.539065Z", "completed_at": "2025-07-24T19:56:08.539065Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025255918502807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_listings", "compiled": true, "compiled_code": "\n\nwith source as (\n  select *\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n)\n\nselect\n    cast(_id                                          as STRING)   as listing_id\n  ,cast(host.host_id                                  as STRING)   as host_id\n  ,cast(name                                          as STRING)   as name\n  ,cast(description                                   as STRING)   as description\n  ,cast(property_type                                 as STRING)   as property_type\n  ,cast(room_type                                     as STRING)   as room_type\n  ,cast(bed_type                                      as STRING)   as bed_type\n  ,cast(minimum_nights                                as INT64)    as minimum_nights\n  ,cast(maximum_nights                                as INT64)    as maximum_nights\n  ,cast(cancellation_policy                           as STRING)   as cancellation_policy\n  ,cast(accommodates                                  as INT64)    as accommodates\n  ,cast(bedrooms                                      as INT64)    as bedrooms\n  ,cast(beds                                          as INT64)    as beds\n  ,cast(number_of_reviews                             as INT64)    as number_of_reviews\n  ,cast(bathrooms                                     as FLOAT64)  as bathrooms\n  ,cast(price                                         as NUMERIC)  as price\n  ,cast(address.country                               as STRING)   as country\n  ,cast(address.market                                as STRING)   as market\n  ,cast(review_scores.review_scores_rating            as INT64)    as review_scores_rating\n  ,cast(review_scores.review_scores_accuracy          as INT64)    as review_scores_accuracy\n  ,cast(review_scores.review_scores_cleanliness       as INT64)    as review_scores_cleanliness\n  ,cast(review_scores.review_scores_checkin           as INT64)    as review_scores_checkin\n  ,cast(review_scores.review_scores_communication     as INT64)    as review_scores_communication\n  ,cast(review_scores.review_scores_location          as INT64)    as review_scores_location\n  ,cast(review_scores.review_scores_value             as INT64)    as review_scores_value\nfrom source", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.530551Z", "completed_at": "2025-07-24T19:56:08.547567Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.547567Z", "completed_at": "2025-07-24T19:56:08.547567Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03396177291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_listings_and_reviews", "compiled": true, "compiled_code": "\n\nwith source as (\n  select\n    cast(_id                                  as STRING)   as listing_id\n    ,cast(host.host_id                        as STRING)   as host_id\n    ,cast(name                                as STRING)   as name\n    ,cast(room_type                           as STRING)   as room_type\n    ,cast(property_type                       as STRING)   as property_type\n    ,cast(price                               as NUMERIC)  as price\n    ,cast(minimum_nights                      as INT64)    as minimum_nights\n    ,cast(maximum_nights                      as INT64)    as maximum_nights\n    ,cast(number_of_reviews                   as INT64)    as number_of_reviews\n    ,cast(accommodates                        as INT64)    as number_of_people\n    ,cast(beds                                as INT64)    as number_of_beds\n    ,cast(bedrooms                            as INT64)    as number_of_bedrooms\n    ,cast(review_scores.review_scores_rating  as FLOAT64)  as review_score\n    ,cast(address.country                     as STRING)   as country\n    ,cast(address.market                      as STRING)   as market\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n)\n\nselect * from source", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings_and_reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.539065Z", "completed_at": "2025-07-24T19:56:08.547567Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.556272Z", "completed_at": "2025-07-24T19:56:08.556272Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02572178840637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_dim_calendar_date_day.52ab57061d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`dim_calendar`\nwhere date_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.538465Z", "completed_at": "2025-07-24T19:56:08.547567Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.556272Z", "completed_at": "2025-07-24T19:56:08.556272Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02572178840637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.stg_reviews", "compiled": true, "compiled_code": "-- models/staging/stg_reviews.sql\n\n\n\nwith source as (\n    select\n        _id         as raw_listing_id,\n        reviews     as raw_reviews_array\n    from `mage-airbnb-pipeline`.`raw_airbnb`.`listings_and_reviews_raw`\n),\n\nexploded as (\n    select\n         cast(raw_listing_id                   as string)  as listing_id\n        ,cast(review.reviewer_id               as string)  as reviewer_id\n        ,cast(review.date                      as date)    as review_date\n        ,cast(review.reviewer_name             as string)  as reviewer_name\n        ,cast(review.comments                  as string)  as review_comment\n    from source\n    cross join unnest(raw_reviews_array) as review\n)\n\nselect * from exploded", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`stg_reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.556272Z", "completed_at": "2025-07-24T19:56:08.563620Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.569914Z", "completed_at": "2025-07-24T19:56:08.569914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025221586227416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_dim_calendar_date_day.9c06a7db88", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select date_day as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`dim_calendar`\n  where date_day is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.563620Z", "completed_at": "2025-07-24T19:56:08.597449Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.597449Z", "completed_at": "2025-07-24T19:56:08.597449Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0338287353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.dim_hosts", "compiled": true, "compiled_code": "\n\nwith raw as (\n  select\n      host_id\n      ,host_name\n      ,host_location\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_hosts`\n)\n\nselect\n  host_id\n  ,any_value(host_name)     as host_name -- Aqui usamos any_value() para pegar um valor arbitr\u00e1rio (e consistente) por host_id.\n  ,any_value(host_location) as host_location\nfrom raw\ngroup by host_id", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`dim_hosts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.572788Z", "completed_at": "2025-07-24T19:56:08.597449Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.606295Z", "completed_at": "2025-07-24T19:56:08.606295Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03350710868835449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_listings_listing_id.5e6409647c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.569914Z", "completed_at": "2025-07-24T19:56:08.606295Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.606295Z", "completed_at": "2025-07-24T19:56:08.606295Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05057215690612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_hosts_host_id.e26f5d6be5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_hosts`\nwhere host_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.572788Z", "completed_at": "2025-07-24T19:56:08.606295Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.606295Z", "completed_at": "2025-07-24T19:56:08.606295Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05057215690612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_listings_host_id.cbb978e7ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\nwhere host_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.614192Z", "completed_at": "2025-07-24T19:56:08.622329Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.630706Z", "completed_at": "2025-07-24T19:56:08.630706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032707929611206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_listings_name.fc5c4b6a44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\nwhere name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.622329Z", "completed_at": "2025-07-24T19:56:08.639003Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.639003Z", "completed_at": "2025-07-24T19:56:08.639003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024605274200439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_listings_price.ad1625f3a9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.630706Z", "completed_at": "2025-07-24T19:56:08.639003Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.639003Z", "completed_at": "2025-07-24T19:56:08.639003Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025079965591430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_stg_listings_listing_id.dd41b56440", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select listing_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\n  where listing_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.630706Z", "completed_at": "2025-07-24T19:56:08.639003Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.647409Z", "completed_at": "2025-07-24T19:56:08.647409Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025079965591430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_listings_and_reviews_listing_id.65c397f63c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings_and_reviews`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.647409Z", "completed_at": "2025-07-24T19:56:08.656393Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.663613Z", "completed_at": "2025-07-24T19:56:08.663613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024610042572021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_stg_listings_and_reviews_listing_id.6fef974cfb", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select listing_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings_and_reviews`\n  where listing_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.656393Z", "completed_at": "2025-07-24T19:56:08.663613Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.663613Z", "completed_at": "2025-07-24T19:56:08.663613Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01641678810119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.trusted_reviews", "compiled": true, "compiled_code": "-- models/trusted/trusted_reviews_aggregated.sql\n\n\n\nselect\n   listing_id\n  ,review_comment\n  ,review_date\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_reviews`\nwhere review_date is not null", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`trusted_reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.656393Z", "completed_at": "2025-07-24T19:56:08.663613Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.663613Z", "completed_at": "2025-07-24T19:56:08.663613Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01641678810119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_reviews_listing_id.bfed550c90", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_reviews`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.663613Z", "completed_at": "2025-07-24T19:56:08.671905Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.672810Z", "completed_at": "2025-07-24T19:56:08.672810Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01641678810119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_stg_reviews_reviewer_id.85e230bf6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`stg_reviews`\nwhere reviewer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.672810Z", "completed_at": "2025-07-24T19:56:08.683503Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.689589Z", "completed_at": "2025-07-24T19:56:08.689589Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025539159774780273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.trusted_listings_enriched", "compiled": true, "compiled_code": "-- models/trusted/trusted_listings_enriched.sql\n\n\n\nwith listings as (\n  select * from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_listings`\n),\n\nhosts as (\n  select * from `mage-airbnb-pipeline`.`raw_airbnb`.`dim_hosts`\n),\n\naddress as (\n  select * from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_address`\n),\n\navailability as (\n  select * from `mage-airbnb-pipeline`.`raw_airbnb`.`stg_availability`\n)\n\nselect\n    l.listing_id\n  ,l.name\n  ,l.description\n  ,l.property_type\n  ,l.room_type\n  ,l.bed_type\n  ,l.minimum_nights\n  ,l.maximum_nights\n  ,l.cancellation_policy\n  ,l.accommodates\n  ,l.bedrooms\n  ,l.beds\n  ,l.number_of_reviews\n  ,l.bathrooms\n  ,l.price\n  ,h.host_id\n  ,h.host_name\n  ,h.host_location\n  ,a.street\n  ,a.suburb\n  ,a.government_area\n  ,a.market\n  ,a.country\n  ,a.latitude\n  ,a.longitude\n  ,a.is_location_exact\n  ,l.review_scores_rating\n  ,l.review_scores_accuracy\n  ,l.review_scores_cleanliness\n  ,l.review_scores_checkin\n  ,l.review_scores_communication\n  ,l.review_scores_location\n  ,l.review_scores_value\n  ,av.available_30\n  ,av.available_60\n  ,av.available_90\n  ,av.available_365\nfrom listings l\nleft join hosts       h  on l.host_id = h.host_id\nleft join address     a  on l.listing_id = a.listing_id\nleft join availability av on l.listing_id = av.listing_id", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`trusted_listings_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.683503Z", "completed_at": "2025-07-24T19:56:08.689589Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.698349Z", "completed_at": "2025-07-24T19:56:08.698349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025539159774780273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_dim_hosts_host_id.091b631476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`dim_hosts`\nwhere host_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.683503Z", "completed_at": "2025-07-24T19:56:08.698349Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.698349Z", "completed_at": "2025-07-24T19:56:08.698349Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02508091926574707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_dim_hosts_host_id.d6a570a203", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select host_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`dim_hosts`\n  where host_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.689589Z", "completed_at": "2025-07-24T19:56:08.698349Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.705712Z", "completed_at": "2025-07-24T19:56:08.705712Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030603408813476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.delivery_reviews_summary", "compiled": true, "compiled_code": "\n\nwith aggregated as (\n  select\n     r.listing_id\n    ,count(*) as review_count\n    ,avg(length(review_comment)) as avg_comment_length\n    ,sum(length(review_comment)) as total_comment_length\n    ,max(review_date) as latest_review_date\n    ,min(review_date) as first_review_date\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_reviews` r\n  group by 1\n)\n\n, enriched as (\n  select\n     a.*\n    ,c.year       as latest_review_year\n    ,c.month      as latest_review_month\n    ,c.week       as latest_review_week\n    ,c.quarter    as latest_review_quarter\n  from aggregated a\n  left join `mage-airbnb-pipeline`.`raw_airbnb`.`dim_calendar` c\n    on a.latest_review_date = c.date_day\n)\n\nselect * from enriched", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`delivery_reviews_summary`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.705712Z", "completed_at": "2025-07-24T19:56:08.722792Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.722792Z", "completed_at": "2025-07-24T19:56:08.722792Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03288745880126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_trusted_reviews_listing_id.55bcdf3fbf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_reviews`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.714107Z", "completed_at": "2025-07-24T19:56:08.722792Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.731237Z", "completed_at": "2025-07-24T19:56:08.731237Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03355526924133301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.delivery_host_summary", "compiled": true, "compiled_code": "\n\nwith enriched as (\n  select\n    host_id,\n    host_name,\n    price,\n    number_of_reviews\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_listings_enriched`\n),\n\nagg as (\n  select\n    host_id,\n    host_name,\n    sum(price)             as total_price,\n    sum(number_of_reviews) as total_reviews\n  from enriched\n  group by 1,2\n)\n\nselect\n  host_id,\n  host_name,\n  total_price,\n  total_reviews,\n  \n    \n  case\n    when total_reviews = 0 then null\n    else total_price / total_reviews\n  end\n as avg_price_per_review\nfrom agg", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`delivery_host_summary`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.722792Z", "completed_at": "2025-07-24T19:56:08.731237Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.731237Z", "completed_at": "2025-07-24T19:56:08.731237Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025160551071166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb_project.delivery_listings_performance", "compiled": true, "compiled_code": "with listings as (\n  select * from `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_listings_enriched`\n),\n\nreviews as (\n  select\n    listing_id\n    ,count(*) as review_count\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_reviews`\n  group by listing_id\n)\n\nselect\n  l.listing_id\n  ,l.name\n  ,l.market\n  ,l.country\n  ,l.price\n  ,l.review_scores_rating            as avg_review_score\n  ,coalesce(r.review_count, 0)       as total_reviews\n  ,l.available_30                    as avail_next_30d\n  ,l.available_90                    as avail_next_90\nfrom listings l\nleft join reviews r\n  on l.listing_id = r.listing_id", "relation_name": "`mage-airbnb-pipeline`.`raw_airbnb`.`delivery_listings_performance`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.722792Z", "completed_at": "2025-07-24T19:56:08.739267Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.739267Z", "completed_at": "2025-07-24T19:56:08.739267Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02451181411743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_trusted_listings_enriched_listing_id.46298fddef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_listings_enriched`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.747304Z", "completed_at": "2025-07-24T19:56:08.755597Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.755597Z", "completed_at": "2025-07-24T19:56:08.755597Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024668455123901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_trusted_listings_enriched_listing_id.e3012d9e4c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select listing_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`trusted_listings_enriched`\n  where listing_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.747304Z", "completed_at": "2025-07-24T19:56:08.755597Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.755597Z", "completed_at": "2025-07-24T19:56:08.755597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01709294319152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_delivery_reviews_summary_listing_id.ccc12b3050", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_reviews_summary`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.755274Z", "completed_at": "2025-07-24T19:56:08.755597Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.763935Z", "completed_at": "2025-07-24T19:56:08.763935Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024518251419067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_delivery_reviews_summary_listing_id.c6f0a00f3e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select listing_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_reviews_summary`\n  where listing_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.755597Z", "completed_at": "2025-07-24T19:56:08.763935Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.772423Z", "completed_at": "2025-07-24T19:56:08.772423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01682591438293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_delivery_host_summary_host_id.d3583d0101", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_host_summary`\nwhere host_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.772423Z", "completed_at": "2025-07-24T19:56:08.883751Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.883751Z", "completed_at": "2025-07-24T19:56:08.883751Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_delivery_listings_performance_listing_id.746a0d8b7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_listings_performance`\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.772423Z", "completed_at": "2025-07-24T19:56:08.883751Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.888669Z", "completed_at": "2025-07-24T19:56:08.888669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11705517768859863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.not_null_delivery_listings_performance_price.0085acc3f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_listings_performance`\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-24T19:56:08.783514Z", "completed_at": "2025-07-24T19:56:08.883751Z"}, {"name": "execute", "started_at": "2025-07-24T19:56:08.888669Z", "completed_at": "2025-07-24T19:56:08.888669Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11705517768859863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb_project.unique_delivery_listings_performance_listing_id.14eadef730", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select listing_id as unique_field\n  from `mage-airbnb-pipeline`.`raw_airbnb`.`delivery_listings_performance`\n  where listing_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.3217720985412598, "args": {"log_format": "default", "log_level_file": "debug", "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "invocation_command": "dbt docs generate", "static_parser": true, "partial_parse": true, "strict_mode": false, "which": "generate", "version_check": true, "log_path": "C:\\Users\\thall\\mage_airbnb_project\\dbt_airbnb_project\\logs", "cache_selected_only": false, "require_resource_names_without_spaces": false, "use_colors": true, "introspect": true, "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "defer": false, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "favor_state": false, "macro_debugging": false, "quiet": false, "send_anonymous_usage_stats": true, "printer_width": 80, "project_dir": "C:\\Users\\thall\\mage_airbnb_project\\dbt_airbnb_project", "skip_nodes_if_on_run_start_fails": false, "print": true, "profiles_dir": "C:\\Users\\thall\\mage_airbnb_project\\dbt_airbnb_project", "write_json": true, "require_nested_cumulative_type_params": false, "log_level": "info", "select": [], "state_modified_compare_vars": false, "indirect_selection": "eager", "use_colors_file": true, "vars": {}, "exclude": [], "static": false, "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "populate_cache": true}}
